if [[ $OSTYPE == "darwin"* ]]; then
    export ZPLUG_HOME=/opt/homebrew/opt/zplug
    source $ZPLUG_HOME/init.zsh
else
    source /usr/share/zsh/scripts/zplug/init.zsh
fi

# plugins
zplug "junegunn/fzf", as:command, from:github, rename-to:fzf
zplug "zsh-users/zsh-autosuggestions", defer:1
zplug "zsh-users/zsh-syntax-highlighting", defer:2
zplug "Aloxaf/fzf-tab", defer:1

# only if kubectl is installed
zplug "ahmetb/kubectx", as:command, from:github, if:'(( $+commands[kubectl] ))'

export TERM='xterm-256color'
if ! zplug check; then
    zplug install
fi

# History Settings
HISTSIZE=10000
HISTFILE=~/.zsh_history
SAVEHIST=$HISTSIZE
HISTDUP=erase

setopt appendhistory
setopt sharehistory
setopt hist_ignore_space
setopt hist_ignore_all_dups
setopt hist_save_no_dups
setopt hist_ignore_dups
setopt hist_find_no_dups

# source plugins and add commands to the PATH
zplug load

# aliases
alias vim="nvim"
alias tf="terraform"
alias k="kubectl"
alias cd="z"
alias ls="ls --color=auto"

# completions
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"
zstyle ':completion:*' menu no
if (( $+commands[kubectl] )); then
    source <(kubectl completion zsh)
fi

if (( $+commands[ng] )); then
    source <(ng completion script)
fi

if (( $+commands[kubectx])); then
    source <(kubectl completion zsh)
fi

# Home brew if macOS
if [[ "$OSTYPE" == "darwin*" ]]; then
		eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

# load 
source <(fzf --zsh)
eval "$(zoxide init zsh)"
eval "$(starship init zsh)"
